<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>League Player Scraper</title>
<style>
body { background:#0a0a0a; color:#0f0; font-family:monospace; padding:20px; }
input { width:320px; padding:8px; background:#111; color:#0f0; border:1px solid #0f0; font-size:14px; }
button { padding:8px 16px; background:#0f0; color:#000; border:none; cursor:pointer; font-weight:bold; margin-left:8px; }
button:hover { background:#0ff; }
pre { margin-top:15px; white-space:pre-wrap; font-size:13px; }
.error { color:#f33; }
.loading { color:#ff0; }
</style>
</head>
<body>
<h3>League Player Info Lookup (NA)</h3>
<input id="summoner" placeholder="Enter summoner name (e.g. cant type-1998)" onkeypress="if(event.key==='Enter')runScrape()">
<button onclick="runScrape()">Fetch Info</button>
<pre id="output"></pre>

<script>
async function fetchProfile(name) {
  const url = `https://www.leagueofgraphs.com/summoner/na/${encodeURIComponent(name)}`;
  const proxied = `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;
  const res = await fetch(proxied);
  if (!res.ok) throw new Error("Failed to load player page");
  const html = await res.text();
  if (!html.includes("<html")) throw new Error("Invalid HTML response");
  return html;
}

function extractBetween(text, start, end) {
  const s = text.indexOf(start);
  if (s === -1) return null;
  const e = text.indexOf(end, s + start.length);
  if (e === -1) return null;
  return text.slice(s + start.length, e).trim();
}

async function runScrape() {
  const name = document.getElementById("summoner").value.trim();
  const out = document.getElementById("output");

  if (!name) {
    out.textContent = "Enter a summoner name first.";
    out.className = "";
    return;
  }

  out.textContent = "Fetching data...";
  out.className = "loading";

  try {
    const html = await fetchProfile(name);
    const doc = new DOMParser().parseFromString(html, "text/html");

    // Basic profile data
    const level = doc.querySelector(".bannerSubtitle")?.textContent.trim() || "Unknown";
    const rankBox = doc.querySelector(".leagueTier")?.textContent.trim() || "Unranked";
    const lp = doc.querySelector(".leaguePoints")?.textContent.trim() || "0 LP";
    const wins = doc.querySelector(".wins")?.textContent.trim() || "0 Wins";
    const losses = doc.querySelector(".losses")?.textContent.trim() || "0 Losses";
    const ratio = doc.querySelector(".ratio")?.textContent.trim() || "";

    // Top 3 played champions (names only)
    const champs = Array.from(doc.querySelectorAll(".summoner-champion-name"))
      .slice(0, 3)
      .map(el => el.textContent.trim());

    const info = {
      Summoner: name,
      Level: level,
      Rank: rankBox,
      LP: lp,
      Wins: wins,
      Losses: losses,
      Ratio: ratio,
      TopChampions: champs
    };

    out.className = "";
    out.textContent = JSON.stringify(info, null, 2);

  } catch (err) {
    out.className = "error";
    out.textContent = "Error: " + err.message;
    console.error(err);
  }
}
</script>
</body>
</html>
