<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>League Player Lookup</title>
<style>
:root {
  --neon:#0f0;--bg:#0a0a0a;--panel:#111;
}
body{background:var(--bg);color:var(--neon);font-family:'Orbitron',monospace;
  padding:40px 20px;display:flex;flex-direction:column;align-items:center;}
h3{margin-bottom:20px;}
.search-box{display:flex;justify-content:center;gap:10px;margin-bottom:25px;}
input{width:280px;padding:10px;background:var(--panel);color:var(--neon);
  border:1px solid var(--neon);font-size:15px;border-radius:6px;}
button{padding:10px 20px;background:var(--neon);color:#000;border:none;
  cursor:pointer;font-weight:bold;border-radius:6px;transition:0.2s;}
button:hover{background:#0ff;}
#player-container{display:none;flex-direction:column;align-items:center;
  background:var(--panel);border:2px solid var(--neon);border-radius:12px;
  padding:25px;max-width:400px;text-align:center;box-shadow:0 0 20px #0f08;
  position:relative;overflow:hidden;}
#player-banner{position:absolute;top:0;left:0;right:0;height:140px;
  background-size:cover;background-position:center;filter:brightness(0.4);}
.player-img{width:120px;height:120px;border-radius:50%;border:2px solid var(--neon);
  object-fit:cover;margin-top:80px;background:#000;z-index:2;}
.stats{display:flex;flex-direction:column;align-items:flex-start;gap:4px;width:100%;
  margin-top:15px;}
.stat{background:#0a0a0a;border:1px solid var(--neon);border-radius:6px;
  padding:8px 10px;width:100%;text-align:left;z-index:2;}
.error{color:#f33;margin-top:20px;}
.loading{color:#ff0;margin-top:20px;}
</style>
</head>
<body>
<h3>League of Graphs â€“ Player Search</h3>

<div class="search-box">
  <input id="summoner" placeholder="Enter summoner name (e.g. Comeback pure)"
         onkeypress="if(event.key==='Enter')runScrape()">
  <button onclick="runScrape()">Search</button>
</div>

<div id="player-container">
  <div id="player-banner"></div>
  <img id="player-img" class="player-img" src="" alt="Summoner Icon" />
  <div id="player-name" class="stat"></div>
  <div class="stats">
    <div id="player-level" class="stat"></div>
    <div id="player-rank" class="stat"></div>
  </div>
</div>

<div id="status" class="loading"></div>

<script>
async function runScrape() {
  const name = document.getElementById("summoner").value.trim();
  const status = document.getElementById("status");
  const container = document.getElementById("player-container");

  if (!name) {
    status.textContent = "Enter a summoner name first.";
    status.className = "error";
    container.style.display = "none";
    return;
  }

  status.textContent = "Fetching data...";
  status.className = "loading";
  container.style.display = "none";

  try {
    // Call the Netlify Function
    const res = await fetch(`/.netlify/functions/league-scrape?name=${encodeURIComponent(name)}`);
    if (!res.ok) throw new Error("Scraper failed");
    const data = await res.json();

    // Apply real data from the function
    document.getElementById("player-banner").style.backgroundImage = `url(${data.banner})`;
    document.getElementById("player-img").src = data.icon;
    document.getElementById("player-name").innerHTML = `<b>Summoner:</b> ${data.name}`;
    document.getElementById("player-level").innerHTML = `<b>Level:</b> ${data.level}`;
    document.getElementById("player-rank").innerHTML = `<b>Rank:</b> ${data.rank}`;

    container.style.display = "flex";
    status.textContent = "";
    status.className = "";
  } catch (err) {
    console.error(err);
    status.textContent = "Error: " + err.message;
    status.className = "error";
  }
}
</script>
</body>
</html>
